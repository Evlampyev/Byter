unit Registration;

interface

uses
  Winapi.Windows, Winapi.Messages, System.SysUtils, System.Variants, System.Classes, Vcl.Graphics,
  Vcl.Controls, Vcl.Forms, Vcl.Dialogs, Vcl.StdCtrls, Vcl.ExtCtrls;

type
  TFormRegistration = class(TForm)
    Button1: TButton;
    NameEdit: TEdit;
    Klass: TComboBox;
    KlassLetter: TComboBox;
    LastNameEdit: TEdit;
    Panel1: TPanel;
    procedure LastNameEditClick(Sender: TObject);
    procedure NameEditClick(Sender: TObject);
    procedure Button1Click(Sender: TObject);
  private
    { Private declarations }
  public
    { Public declarations }
  end;

var
  FormRegistration: TFormRegistration;

implementation

{$R *.dfm}

Uses разминка;

procedure TFormRegistration.Button1Click(Sender: TObject);
Var
  Len, i : Byte;
  Incorrect: Boolean;
  Sln, Sn : String;
  SendText: UnicodeString;

begin
    Incorrect := False;
    Sln := LastNameEdit.Text;
    Len := Length (Sln);
    for i := 1 to Len do
        {if ((Ord (Sln[i]) < 1040) or (Ord (Sln[i]) > 1103)) then Incorrect := True;} //проверка на русский язык
    Sln := NameEdit.Text;
    Len := Length (Sln);
    for i := 1 to Len do
{        if ((Ord (Sln[i]) < 1040) or (Ord (Sln[i]) > 1103)) then Incorrect := True;} // проверка на русский язык
  if Incorrect then ShowMessage ('Неверный ввод')
  Else
  if LastNameEdit.Text='' Then ShowMessage ('Введите Фамилию')
    Else if NameEdit.Text='' Then ShowMessage ('Введите Имя')
      Else If (klass.ItemIndex=-1) or (klassLetter.ItemIndex=-1) Then ShowMessage ('Выберете класс')
    Else
    Begin
      NameI := NameEdit.Text;
      School := Klass.Items [Klass.ItemIndex]+ ' ' + KlassLetter.Items [Klass.ItemIndex];
      LastName := LastNameEdit.Text;
      Razm.RegLabel.Caption :=   LastName+ ' ' + NameI + ' ' + School;
      SendText := Razm.RegLabel.Caption + ' ' + IntToStr(Level) + ' ' + '0:0' + ' ' + '0';
      Razm.RegLabel.Visible := True;

      try
        Razm.IdTCPClient1.Connect;
        Razm.IdTCPClient1.IOHandler.WriteLn(AnsiToUTF8(SendText));
        Razm.IdTCPClient1.Disconnect;
        Razm.ConnectLabel.Caption := 'Cвязь есть';
      except
        Razm.ConnectLabel.Caption := 'Нет связи';
      end;


      {
      Razm.IdTCPClient1.Connect;

      Razm.IdTCPClient1.IOHandler.WriteLn(SendText);
      Razm.IdTCPClient1.Disconnect;}

      Close;
    End;

end;

procedure TFormRegistration.LastNameEditClick(Sender: TObject);
begin
LastNameEdit.Text := '';
end;

procedure TFormRegistration.NameEditClick(Sender: TObject);
begin
  NameEdit.Text := '';
end;


end.
